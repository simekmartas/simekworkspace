<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Bazar - Mobil Maj√°k</title>
    <!-- Legacy Browser Support First -->
    <script src="legacy-browser-support.js"></script>
    <link rel="stylesheet" href="legacy-browser-styles.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#ff1493">
    
    <style>
        /* CSS styly pro date picker s rolov√°tky */
        .date-input-container {
            position: relative;
        }
        
        .date-toggle-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 2px 6px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 32px;
            width: 32px;
        }
        
        .date-toggle-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        .dark-theme .date-toggle-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .date-selects {
            display: none;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 0.5rem;
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: var(--secondary-color, #f8f9fa);
            border-radius: 8px;
            border: 1px solid var(--border-color, #e0e0e0);
        }
        
        .dark-theme .date-selects {
            background: rgba(30, 41, 59, 0.5);
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .date-select {
            padding: 8px;
            border: 1px solid var(--border-color, #ccc);
            border-radius: 4px;
            background: var(--input-background, white);
            color: var(--text-primary, #333);
            font-size: 14px;
            font-family: inherit;
        }
        
        .date-select:focus {
            outline: none;
            border-color: var(--primary-color, #2196F3);
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
        }
        
        .dark-theme .date-select {
            background: rgba(30, 41, 59, 0.8);
            border-color: rgba(255, 255, 255, 0.2);
            color: #f8fafc;
        }
        
        .dark-theme .date-select:focus {
            border-color: var(--primary-color, #2196F3);
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.3);
        }
        
        /* Responzivn√≠ design pro mobiln√≠ za≈ô√≠zen√≠ */
        @media (max-width: 768px) {
            .date-selects {
                grid-template-columns: 1fr;
                gap: 0.25rem;
            }
            
            .date-select {
                padding: 12px;
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }
        
        /* Animace pro show/hide date select≈Ø */
        .date-selects.show {
            display: grid;
            animation: slideDown 0.3s ease-in-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Styling pro date input kdy≈æ jsou aktivn√≠ rolov√°tka */
        .date-input-container.using-selects input {
            background-color: var(--disabled-background, #f5f5f5);
            color: var(--text-secondary, #666);
        }
        
        .dark-theme .date-input-container.using-selects input {
            background-color: rgba(30, 41, 59, 0.3);
            color: #94a3b8;
        }
        
        /* CSS styly pro animace √∫spƒõchu a chyby */
        .success-emoji, .error-emoji {
            position: fixed;
            font-size: 4rem;
            z-index: 10000;
            animation: bounceIn 0.6s ease-out;
            pointer-events: none;
        }
        
        .celebration-text, .error-text {
            position: fixed;
            top: 45%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: #2563eb;
            z-index: 10000;
            animation: slideInUp 0.8s ease-out;
            pointer-events: none;
            text-align: center;
        }
        
        .error-text {
            color: #dc2626;
        }
        
        @keyframes bounceIn {
            0% { transform: translateX(-50%) scale(0.3); opacity: 0; }
            50% { transform: translateX(-50%) scale(1.05); }
            70% { transform: translateX(-50%) scale(0.9); }
            100% { transform: translateX(-50%) scale(1); opacity: 1; }
        }
        
        @keyframes slideInUp {
            0% { transform: translateX(-50%) translateY(20px); opacity: 0; }
            100% { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        
        /* Konfety animace */
        .animation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7);
            animation: confettiFall linear infinite;
            border-radius: 50%;
        }
        
        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* Sparkle animace */
        .sparkle {
            position: absolute;
            font-size: 1.5rem;
            animation: sparkleFloat 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes sparkleFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 1; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.5; }
        }
        
        /* Glow efekt pro √∫spƒõch */
        .form-success-glow {
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.5);
            border: 2px solid #22c55e;
            animation: successGlow 2s ease-in-out;
        }
        
        @keyframes successGlow {
            0% { box-shadow: 0 0 30px rgba(34, 197, 94, 0.5); }
            50% { box-shadow: 0 0 60px rgba(34, 197, 94, 0.8); }
            100% { box-shadow: 0 0 30px rgba(34, 197, 94, 0.5); }
        }
        
        /* Shake efekt pro chybu */
        .form-error-shake {
            animation: errorShake 0.6s ease-in-out;
            border: 2px solid #ef4444;
        }
        
        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Spinning animace pro loading tlaƒç√≠tko */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="protected-page">
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">Mobil Maj√°k</a>
            <nav>
                <ul>
                    <!-- Navigace bude vlo≈æena JavaScriptem -->
                </ul>
            </nav>
            <!-- Theme toggle a hamburger menu budou p≈ôid√°ny navigation.js -->
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <h1>Bazar</h1>
                <p>Statistiky bazarov√Ωch prodej≈Ø</p>
            </div>
        </section>

        <section>
            <div class="container">
                <!-- Tlaƒç√≠tko pro p≈ôid√°n√≠ nov√©ho bazaru -->
                <div style="text-align: center; margin: 2rem 0;">
                    <button id="newBazarBtn" class="btn btn-primary" style="margin-bottom: 2rem;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Nov√Ω Bazar
                    </button>
                </div>

                <!-- Formul√°≈ô pro nov√Ω bazar (skryt√Ω) -->
                <div id="newBazarForm" class="data-container" style="display: none; max-width: 800px; margin: 2rem auto;">
                    <div class="data-header">
                        <div class="data-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <path d="M9 9h6v6H9z"></path>
                            </svg>
                            Nov√Ω z√°znam do bazaru
                        </div>
                        <button id="closeFormBtn" style="background: none; border: none; color: var(--text-secondary); cursor: pointer;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="bazarForm" style="padding: 2rem;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                            <!-- Z√°kladn√≠ informace -->
                            <div>
                                <label for="vykupka" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    V√Ωkupka *
                                </label>
                                <input type="text" id="vykupka" name="vykupka" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="typTelefonu" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Typ telefonu *
                                </label>
                                <input type="text" id="typTelefonu" name="typTelefonu" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="imei" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    IMEI *
                                </label>
                                <input type="text" id="imei" name="imei" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="jakSeONasDozvedelKlient" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Jak se o n√°s klient dozvƒõdƒõl?
                                </label>
                                <select id="jakSeONasDozvedelKlient" name="jakSeONasDozvedelKlient" style="width: 100%;">
                                    <option value="">Vyberte...</option>
                                    <option value="internet">Internet</option>
                                    <option value="facebook">Facebook</option>
                                    <option value="google">Google</option>
                                    <option value="doporuceni">Doporuƒçen√≠</option>
                                    <option value="reklama">Reklama</option>
                                    <option value="prochazka">Proch√°zka kolem</option>
                                    <option value="jine">Jin√©</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="cena" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Cena (Kƒç) *
                                </label>
                                <input type="number" id="cena" name="cena" required style="width: 100%;" min="0" step="1">
                            </div>
                            
                            <!-- P≈ô√≠slu≈°enstv√≠ -->
                            <div>
                                <label for="nabijjecka" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Nab√≠jeƒçka
                                </label>
                                <select id="nabijjecka" name="nabijjecka" style="width: 100%;">
                                    <option value="ne">Ne</option>
                                    <option value="ano">Ano</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="krabicka" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Krabiƒçka
                                </label>
                                <select id="krabicka" name="krabicka" style="width: 100%;">
                                    <option value="ne">Ne</option>
                                    <option value="ano">Ano</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="zarucniList" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Z√°ruƒçn√≠ list
                                </label>
                                <select id="zarucniList" name="zarucniList" style="width: 100%;">
                                    <option value="ne">Ne</option>
                                    <option value="ano">Ano</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="zarukaDo" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Z√°ruka do
                                    <small style="color: var(--text-secondary); font-weight: normal;">(DD.MM.YYYY nebo rolov√°tka)</small>
                                </label>
                                <div class="date-input-container">
                                    <div style="position: relative; width: 100%;">
                                        <input type="text" id="zarukaDo" name="zarukaDo" 
                                               style="width: 100%; padding-right: 45px;" 
                                               placeholder="nap≈ô. 15.12.2025" 
                                               pattern="^([0-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.([0-9]{4})$"
                                               title="Zadejte datum ve form√°tu DD.MM.YYYY">
                                        <button type="button" class="date-toggle-btn" onclick="toggleDateInput('zarukaDo')" title="P≈ôepnout na rolov√°tka">
                                            üìÖ
                                        </button>
                                    </div>
                                    <div class="date-selects" id="zarukaDo_selects" style="display: none;">
                                        <select class="date-select day-select" data-field="zarukaDo">
                                            <option value="">Den</option>
                                        </select>
                                        <select class="date-select month-select" data-field="zarukaDo">
                                            <option value="">Mƒõs√≠c</option>
                                            <option value="01">Leden</option>
                                            <option value="02">√önor</option>
                                            <option value="03">B≈ôezen</option>
                                            <option value="04">Duben</option>
                                            <option value="05">Kvƒõten</option>
                                            <option value="06">ƒåerven</option>
                                            <option value="07">ƒåervenec</option>
                                            <option value="08">Srpen</option>
                                            <option value="09">Z√°≈ô√≠</option>
                                            <option value="10">≈ò√≠jen</option>
                                            <option value="11">Listopad</option>
                                            <option value="12">Prosinec</option>
                                        </select>
                                        <select class="date-select year-select" data-field="zarukaDo">
                                            <option value="">Rok</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <label for="pouziteDily" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Pou≈æit√© d√≠ly (Kƒç)
                                </label>
                                <input type="number" id="pouziteDily" name="pouziteDily" style="width: 100%;" min="0" step="1" value="0">
                            </div>
                            
                            <div>
                                <label for="vykoupil" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Vykoupil (p≈ô√≠jmen√≠) *
                                </label>
                                <input type="text" id="vykoupil" name="vykoupil" required style="width: 100%;">
                            </div>
                        </div>
                        
                        <!-- Informace o klientovi -->
                        <h3 style="color: var(--text-primary); margin: 2rem 0 1rem 0; font-size: 1.25rem;">Informace o klientovi</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                            <div>
                                <label for="jmenoKlienta" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Jm√©no klienta *
                                </label>
                                <input type="text" id="jmenoKlienta" name="jmenoKlienta" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="prijmeniKlienta" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    P≈ô√≠jmen√≠ klienta *
                                </label>
                                <input type="text" id="prijmeniKlienta" name="prijmeniKlienta" required style="width: 100%;">
                            </div>
                            
                            <div style="grid-column: 1 / -1;">
                                <label for="adresaKlienta" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Adresa klienta *
                                </label>
                                <input type="text" id="adresaKlienta" name="adresaKlienta" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="rodneCislo" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Rodn√© ƒç√≠slo *
                                </label>
                                <input type="text" id="rodneCislo" name="rodneCislo" required style="width: 100%;" placeholder="000000/0000">
                            </div>
                            
                            <div>
                                <label for="rodinnyStav" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Rodinn√Ω stav
                                </label>
                                <select id="rodinnyStav" name="rodinnyStav" style="width: 100%;">
                                    <option value="">Vyberte...</option>
                                    <option value="svobodn√Ω/√°">Svobodn√Ω/√°</option>
                                    <option value="≈æenat√Ω/vdan√°">≈Ωenat√Ω/vdan√°</option>
                                    <option value="rozveden√Ω/√°">Rozveden√Ω/√°</option>
                                    <option value="vdovec/vdova">Vdovec/vdova</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="mistoVydaniDokladu" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    M√≠sto vyd√°n√≠ dokladu *
                                </label>
                                <input type="text" id="mistoVydaniDokladu" name="mistoVydaniDokladu" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="datumVydaniDokladu" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Datum vyd√°n√≠ OP *
                                    <small style="color: var(--text-secondary); font-weight: normal;">(DD.MM.YYYY nebo rolov√°tka)</small>
                                </label>
                                <div class="date-input-container">
                                    <div style="position: relative; width: 100%;">
                                        <input type="text" id="datumVydaniDokladu" name="datumVydaniDokladu" required 
                                               style="width: 100%; padding-right: 45px;" 
                                               placeholder="nap≈ô. 10.01.2020" 
                                               pattern="^([0-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.([0-9]{4})$"
                                               title="Zadejte datum ve form√°tu DD.MM.YYYY">
                                        <button type="button" class="date-toggle-btn" onclick="toggleDateInput('datumVydaniDokladu')" title="P≈ôepnout na rolov√°tka">
                                            üìÖ
                                        </button>
                                    </div>
                                    <div class="date-selects" id="datumVydaniDokladu_selects" style="display: none;">
                                        <select class="date-select day-select" data-field="datumVydaniDokladu">
                                            <option value="">Den</option>
                                        </select>
                                        <select class="date-select month-select" data-field="datumVydaniDokladu">
                                            <option value="">Mƒõs√≠c</option>
                                            <option value="01">Leden</option>
                                            <option value="02">√önor</option>
                                            <option value="03">B≈ôezen</option>
                                            <option value="04">Duben</option>
                                            <option value="05">Kvƒõten</option>
                                            <option value="06">ƒåerven</option>
                                            <option value="07">ƒåervenec</option>
                                            <option value="08">Srpen</option>
                                            <option value="09">Z√°≈ô√≠</option>
                                            <option value="10">≈ò√≠jen</option>
                                            <option value="11">Listopad</option>
                                            <option value="12">Prosinec</option>
                                        </select>
                                        <select class="date-select year-select" data-field="datumVydaniDokladu">
                                            <option value="">Rok</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <label for="platnostDo" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Platnost OP *
                                    <small style="color: var(--text-secondary); font-weight: normal;">(DD.MM.YYYY nebo rolov√°tka)</small>
                                </label>
                                <div class="date-input-container">
                                    <div style="position: relative; width: 100%;">
                                        <input type="text" id="platnostDo" name="platnostDo" required 
                                               style="width: 100%; padding-right: 45px;" 
                                               placeholder="nap≈ô. 10.01.2030" 
                                               pattern="^([0-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.([0-9]{4})$"
                                               title="Zadejte datum ve form√°tu DD.MM.YYYY">
                                        <button type="button" class="date-toggle-btn" onclick="toggleDateInput('platnostDo')" title="P≈ôepnout na rolov√°tka">
                                            üìÖ
                                        </button>
                                    </div>
                                    <div class="date-selects" id="platnostDo_selects" style="display: none;">
                                        <select class="date-select day-select" data-field="platnostDo">
                                            <option value="">Den</option>
                                        </select>
                                        <select class="date-select month-select" data-field="platnostDo">
                                            <option value="">Mƒõs√≠c</option>
                                            <option value="01">Leden</option>
                                            <option value="02">√önor</option>
                                            <option value="03">B≈ôezen</option>
                                            <option value="04">Duben</option>
                                            <option value="05">Kvƒõten</option>
                                            <option value="06">ƒåerven</option>
                                            <option value="07">ƒåervenec</option>
                                            <option value="08">Srpen</option>
                                            <option value="09">Z√°≈ô√≠</option>
                                            <option value="10">≈ò√≠jen</option>
                                            <option value="11">Listopad</option>
                                            <option value="12">Prosinec</option>
                                        </select>
                                        <select class="date-select year-select" data-field="platnostDo">
                                            <option value="">Rok</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <label for="datumNarozeni" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Datum narozen√≠ *
                                    <small style="color: var(--text-secondary); font-weight: normal;">(DD.MM.YYYY nebo rolov√°tka)</small>
                                </label>
                                <div class="date-input-container">
                                    <div style="position: relative; width: 100%;">
                                        <input type="text" id="datumNarozeni" name="datumNarozeni" required 
                                               style="width: 100%; padding-right: 45px;" 
                                               placeholder="nap≈ô. 15.03.1990" 
                                               pattern="^([0-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.([0-9]{4})$"
                                               title="Zadejte datum ve form√°tu DD.MM.YYYY">
                                        <button type="button" class="date-toggle-btn" onclick="toggleDateInput('datumNarozeni')" title="P≈ôepnout na rolov√°tka">
                                            üìÖ
                                        </button>
                                    </div>
                                    <div class="date-selects" id="datumNarozeni_selects" style="display: none;">
                                        <select class="date-select day-select" data-field="datumNarozeni">
                                            <option value="">Den</option>
                                        </select>
                                        <select class="date-select month-select" data-field="datumNarozeni">
                                            <option value="">Mƒõs√≠c</option>
                                            <option value="01">Leden</option>
                                            <option value="02">√önor</option>
                                            <option value="03">B≈ôezen</option>
                                            <option value="04">Duben</option>
                                            <option value="05">Kvƒõten</option>
                                            <option value="06">ƒåerven</option>
                                            <option value="07">ƒåervenec</option>
                                            <option value="08">Srpen</option>
                                            <option value="09">Z√°≈ô√≠</option>
                                            <option value="10">≈ò√≠jen</option>
                                            <option value="11">Listopad</option>
                                            <option value="12">Prosinec</option>
                                        </select>
                                        <select class="date-select year-select" data-field="datumNarozeni">
                                            <option value="">Rok</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <label for="pohlavi" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Pohlav√≠ *
                                </label>
                                <select id="pohlavi" name="pohlavi" required style="width: 100%;">
                                    <option value="">Vyberte...</option>
                                    <option value="mu≈æ">Mu≈æ</option>
                                    <option value="≈æena">≈Ωena</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="cisloOP" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    ƒå√≠slo OP *
                                </label>
                                <input type="text" id="cisloOP" name="cisloOP" required style="width: 100%;" placeholder="123456789">
                            </div>
                            
                            <div>
                                <label for="mistoNarozeni" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    M√≠sto narozen√≠ *
                                </label>
                                <input type="text" id="mistoNarozeni" name="mistoNarozeni" required style="width: 100%;">
                            </div>
                            
                            <div>
                                <label for="telefonniCislo" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Telefonn√≠ ƒç√≠slo
                                </label>
                                <input type="tel" id="telefonniCislo" name="telefonniCislo" style="width: 100%;" placeholder="+420 123 456 789">
                            </div>
                            
                            <div style="grid-column: 1 / -1;">
                                <label for="poznamky" style="display: block; font-weight: 500; color: var(--text-primary); margin-bottom: 0.5rem;">
                                    Pozn√°mky
                                </label>
                                <textarea id="poznamky" name="poznamky" style="width: 100%; min-height: 80px; resize: vertical;" placeholder="Dal≈°√≠ pozn√°mky k v√Ωkupu..."></textarea>
                            </div>
                        </div>
                        
                        <!-- Tlaƒç√≠tka -->
                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap;">
                            <button type="button" id="cancelFormBtn" style="background: var(--text-secondary); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer;">
                                Zru≈°it
                            </button>
                            <button type="button" id="testFormBtn" style="background: #6366f1; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer;" title="Vypln√≠ testovac√≠ data a ode≈°le formul√°≈ô">
                                üß™ Test formul√°≈ôe
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9,11 12,14 22,4"></polyline>
                                    <path d="M21,12v7a2,2 0,0 1,-2,2H5a2,2 0,0 1,-2,-2V5a2,2 0,0 1,2,-2h11"></path>
                                </svg>
                                Dokonƒçit
                            </button>
                        </div>
                    </form>
                    
                    <div id="formMessage" class="message" style="display: none; margin: 1rem 2rem;"></div>
                </div>

                <div id="bazarDataContainer">
                    <!-- Bazarov√° data budou naƒçtena zde -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Mobil Maj√°k. V≈°echna pr√°va vyhrazena.</p>
        </div>
    </footer>

    <div class="version-info">v2.3.0</div>

    <script src="access-control.js"></script>
    <script src="theme-toggle.js"></script>
    <script src="sales-assistant.js"></script>
    <script src="navigation.js?v=1.0.1"></script>
    <script src="image-upload.js"></script>
    <!-- AI chatbot skryt√Ω -->
    <!-- <script src="ai-chatbot.js"></script> -->
    <script src="bazar-storage.js"></script>
    <script src="bazar-data-loader.js"></script>
    <script>
        // Inicializace bazarov√©ho data loaderu s lep≈°√≠m error handlingem
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Bazar.html inicializace dokonƒçena');
            
            // Funkce pro inicializaci s retry logikou
            function initializeBazarLoader(attempt = 1) {
                console.log(`üìä Pokus o inicializaci #${attempt}`);
                console.log('üîê Stav autentifikace:', document.body.classList.contains('authenticated'));
                console.log('üìú V≈°echny t≈ô√≠dy body:', document.body.className);
                console.log('üë§ Role u≈æivatele:', localStorage.getItem('role'));
                console.log('üîë P≈ôihl√°≈°en:', localStorage.getItem('isLoggedIn'));
                
                try {
                    // V≈ædy spust√≠me inicializaci - access control se ≈ôe≈°√≠ v access-control.js
                    console.log('‚úÖ Spou≈°t√≠m inicializaci bazarov√©ho loaderu...');
                    
                    // Kontrola existence kontejneru
                    const container = document.getElementById('bazarDataContainer');
                    if (!container) {
                        console.error('‚ùå Kontejner bazarDataContainer nenalezen!');
                        return;
                    }
                    
                    // Inicializace bazarov√©ho data loaderu
                    window.bazarLoader = new BazarDataLoader('bazarDataContainer');
                    console.log('üìä BazarDataLoader vytvo≈ôen');
                    
                    // Naƒçten√≠ dat
                    window.bazarLoader.loadBazarData();
                    console.log('üìà loadBazarData() spu≈°tƒõno');
                    
                    // Inicializace formul√°≈ôe pro nov√Ω bazar
                    initBazarForm();
                    console.log('üìù Formul√°≈ô inicializov√°n');
                    
                } catch (error) {
                    console.error('‚ùå Chyba p≈ôi inicializaci:', error);
                    
                    // Retry pouze pokud jsme nezkusili v√≠ckr√°t ne≈æ 3x
                    if (attempt < 3) {
                        console.log(`üîÑ Opakuji za 1 sekundu (pokus ${attempt + 1}/3)`);
                        setTimeout(() => initializeBazarLoader(attempt + 1), 1000);
                    } else {
                        console.error('üíÄ Inicializace selhala po 3 pokusech');
                        
                        // Zobraz√≠me chybovou zpr√°vu u≈æivateli
                        const container = document.getElementById('bazarDataContainer');
                        if (container) {
                            container.innerHTML = `
                                <div style="
                                    padding: 2rem;
                                    text-align: center;
                                    background: var(--bg-secondary);
                                    border-radius: 8px;
                                    border: 1px solid var(--border-light);
                                    margin: 2rem 0;
                                ">
                                    <h3 style="color: var(--error); margin-bottom: 1rem;">‚ö†Ô∏è Chyba p≈ôi naƒç√≠t√°n√≠ dat</h3>
                                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                                        Nepoda≈ôilo se naƒç√≠st bazarov√° data. Zkuste obnovit str√°nku.
                                    </p>
                                    <button onclick="window.location.reload()" style="
                                        background: var(--accent-blue);
                                        color: white;
                                        border: none;
                                        padding: 0.75rem 1.5rem;
                                        border-radius: 0.5rem;
                                        cursor: pointer;
                                        font-weight: 600;
                                    ">
                                        üîÑ Obnovit str√°nku
                                    </button>
                                </div>
                            `;
                        }
                    }
                }
                
                // Theme manager
                try {
                    if (window.themeManager) {
                        window.themeManager.createThemeToggle();
                        console.log('üé® Theme toggle buttons aktualizov√°ny');
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è Chyba p≈ôi inicializaci theme manageru:', error);
                }
            }
            
            // Spustit inicializaci s mal√Ωm zpo≈ædƒõn√≠m pro naƒçten√≠ v≈°ech skript≈Ø
            setTimeout(initializeBazarLoader, 100);
        });
        
        // Funkce pro inicializaci formul√°≈ôe
        function initBazarForm() {
            console.log('üîß Inicializuji bazar formul√°≈ô...');
            
            const newBazarBtn = document.getElementById('newBazarBtn');
            const newBazarForm = document.getElementById('newBazarForm');
            const closeFormBtn = document.getElementById('closeFormBtn');
            const cancelFormBtn = document.getElementById('cancelFormBtn');
            const bazarForm = document.getElementById('bazarForm');
            const formMessage = document.getElementById('formMessage');
            
            console.log('üîç Kontrola element≈Ø:', {
                newBazarBtn: !!newBazarBtn,
                newBazarForm: !!newBazarForm,
                closeFormBtn: !!closeFormBtn,
                cancelFormBtn: !!cancelFormBtn,
                bazarForm: !!bazarForm,
                formMessage: !!formMessage
            });
            
            if (!newBazarBtn) {
                console.error('‚ùå Tlaƒç√≠tko newBazarBtn nenalezeno!');
                console.log('üîç Elementy v DOM:', document.querySelectorAll('[id*="azar"]'));
                
                // Zkus√≠me naj√≠t tlaƒç√≠tko pozdƒõji
                setTimeout(() => {
                    console.log('üîÑ Opakuji hled√°n√≠ tlaƒç√≠tka...');
                    const retryBtn = document.getElementById('newBazarBtn');
                    if (retryBtn) {
                        console.log('‚úÖ Tlaƒç√≠tko nalezeno p≈ôi opakov√°n√≠!');
                        initBazarForm();
                    } else {
                        console.error('‚ùå Tlaƒç√≠tko st√°le nenalezeno');
                    }
                }, 1000);
                return;
            }
            
            if (!newBazarForm) {
                console.error('‚ùå Formul√°≈ô newBazarForm nenalezen!');
                return;
            }
            
            // Kontrola CSS vlastnost√≠ tlaƒç√≠tka
            const btnStyles = window.getComputedStyle(newBazarBtn);
            console.log('üé® CSS vlastnosti tlaƒç√≠tka:', {
                display: btnStyles.display,
                visibility: btnStyles.visibility,
                opacity: btnStyles.opacity,
                pointerEvents: btnStyles.pointerEvents,
                position: btnStyles.position
            });
            
            // Zobrazen√≠ formul√°≈ôe
            const clickHandler = function() {
                console.log('üîò Kliknuto na tlaƒç√≠tko Nov√Ω bazar');
                newBazarForm.style.display = 'block';
                newBazarBtn.style.display = 'none';
                // Scroll k formul√°≈ôi
                newBazarForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
            };
            
            // P≈ôid√°n√≠ event listeneru s kontrolou
            try {
                newBazarBtn.addEventListener('click', clickHandler);
                console.log('‚úÖ Event listener pro Nov√Ω bazar p≈ôid√°n');
                
                // Test funkƒçnosti tlaƒç√≠tka
                newBazarBtn.style.cursor = 'pointer';
                newBazarBtn.title = 'Kliknƒõte pro otev≈ôen√≠ formul√°≈ôe';
                
                // P≈ôid√°n√≠ alternativn√≠ho zp≈Øsobu pro debug
                newBazarBtn.onclick = function(e) {
                    console.log('üîò Onclick handler spu≈°tƒõn');
                    clickHandler();
                };
                
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi p≈ôid√°v√°n√≠ event listeneru:', error);
            }
            
            // Skryt√≠ formul√°≈ôe
            function hideForm() {
                newBazarForm.style.display = 'none';
                newBazarBtn.style.display = 'block';
                bazarForm.reset();
                hideMessage();
            }
            
            closeFormBtn.addEventListener('click', hideForm);
            cancelFormBtn.addEventListener('click', hideForm);
            
            // Testovac√≠ tlaƒç√≠tko
            const testFormBtn = document.getElementById('testFormBtn');
            if (testFormBtn) {
                testFormBtn.addEventListener('click', function() {
                    console.log('üß™ Spou≈°t√≠m testovac√≠ vyplnƒõn√≠ formul√°≈ôe...');
                    fillTestData();
                    console.log('üß™ Testovac√≠ data vyplnƒõna, odes√≠l√°m formul√°≈ô...');
                    // Simulovat odesl√°n√≠ formul√°≈ôe
                    setTimeout(() => {
                        bazarForm.dispatchEvent(new Event('submit'));
                    }, 500);
                });
            }
            
            // Odesl√°n√≠ formul√°≈ôe
            bazarForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validace formul√°≈ôe
                const validationResult = validateForm();
                if (!validationResult.isValid) {
                    showErrorAnimation(validationResult.errors);
                    showMessage(validationResult.errors.join(', '), 'error');
                    return;
                }
                
                // Sbƒõr dat z formul√°≈ôe
                const formData = new FormData(bazarForm);
                const bazarData = {
                    datum: new Date().toISOString().split('T')[0], // Souƒçasn√© datum
                    cas: new Date().toLocaleTimeString('cs-CZ'),
                    vykupka: formData.get('vykupka'),
                    typTelefonu: formData.get('typTelefonu'),
                    imei: formData.get('imei'),
                    jakSeONasDozvedelKlient: formData.get('jakSeONasDozvedelKlient'),
                    cena: parseInt(formData.get('cena')),
                    nabijjecka: formData.get('nabijjecka'),
                    krabicka: formData.get('krabicka'),
                    zarucniList: formData.get('zarucniList'),
                    zarukaDo: convertDateFormat(formData.get('zarukaDo')),
                    pouziteDily: parseInt(formData.get('pouziteDily')) || 0,
                    vykoupil: formData.get('vykoupil'),
                    jmenoKlienta: formData.get('jmenoKlienta'),
                    prijmeniKlienta: formData.get('prijmeniKlienta'),
                    adresaKlienta: formData.get('adresaKlienta'),
                    rodneCislo: formData.get('rodneCislo'),
                    rodinnyStav: formData.get('rodinnyStav'),
                    mistoVydaniDokladu: formData.get('mistoVydaniDokladu'),
                    datumVydaniDokladu: convertDateFormat(formData.get('datumVydaniDokladu')),
                    platnostDo: convertDateFormat(formData.get('platnostDo')),
                    datumNarozeni: convertDateFormat(formData.get('datumNarozeni')),
                    pohlavi: formData.get('pohlavi'),
                    cisloOP: formData.get('cisloOP'),
                    mistoNarozeni: formData.get('mistoNarozeni'),
                    telefonniCislo: formData.get('telefonniCislo'),
                    poznamky: formData.get('poznamky')
                };
                
                // Ulo≈æen√≠ dat
                saveBazarData(bazarData);
            });
            
            // Zobrazen√≠/skryt√≠ zpr√°vy
            function showMessage(text, type) {
                formMessage.textContent = text;
                formMessage.className = `message ${type}`;
                formMessage.style.display = 'block';
                formMessage.style.animation = 'fadeIn 0.3s ease-in-out';
            }
            
            function hideMessage() {
                formMessage.style.display = 'none';
                formMessage.style.animation = '';
            }
            
            // Konverze DD.MM.YYYY na YYYY-MM-DD nebo zachov√°n√≠ pr√°zdn√© hodnoty
            function convertDateFormat(dateString) {
                if (!dateString || dateString.trim() === '') {
                    return '';
                }
                
                const parts = dateString.split('.');
                if (parts.length === 3) {
                    const day = parts[0].padStart(2, '0');
                    const month = parts[1].padStart(2, '0');
                    const year = parts[2];
                    return `${year}-${month}-${day}`;
                }
                
                return dateString; // Vr√°tit p≈Øvodn√≠ pokud nen√≠ ve spr√°vn√©m form√°tu
            }
            
            // Funkce pro ulo≈æen√≠ dat do Google Sheets p≈ôes Google Apps Script
            async function saveBazarData(data) {
                const submitButton = document.querySelector('button[type="submit"]');
                const originalButtonText = submitButton.innerHTML;
                
                try {
                    // Zobrazit loading stav
                    submitButton.disabled = true;
                    submitButton.innerHTML = `
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite;">
                            <path d="M21 12a9 9 0 11-6.219-8.56"/>
                        </svg>
                        Odes√≠l√°m...
                    `;
                    
                    console.log('üöÄ Odes√≠l√°m data na Google Apps Script:', data);
                    
                    // P≈ô√≠prava dat pro Google Apps Script ve spr√°vn√©m form√°tu
                    const payload = {
                        action: 'addRecord',
                        data: data
                    };
                    
                    console.log('üìã Payload pro odesl√°n√≠:', payload);
                    
                    // Zkus√≠me prvn√≠ POST s JSON
                    console.log('üîÑ Pokus #1: POST s JSON');
                    
                    let finalResponse;
                    
                    try {
                        // Pokus #1: POST s FormData (l√©pe funguje s Google Apps Script)
                        console.log('üîÑ Pokus #1: POST s FormData');
                        
                        const formData = new FormData();
                        
                        // P≈ôid√°n√≠ akce
                        formData.append('action', payload.action);
                        
                        // P≈ôid√°n√≠ v≈°ech dat z formul√°≈ôe
                        Object.keys(payload.data).forEach(key => {
                            const value = payload.data[key];
                            if (value !== null && value !== undefined && value !== '') {
                                formData.append(key, value.toString());
                            }
                        });
                        
                        console.log('üìã FormData obsahuje:', Array.from(formData.entries()).map(([k, v]) => `${k}: ${v}`));
                        
                        finalResponse = await fetch('https://script.google.com/macros/s/AKfycbyPrVbibH_2dCL-9MFRYkSURIV4_bQdruuX-BrGT00Z0kJTOP8cqs3kZ9SaOpXZ7qFA/exec', {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!finalResponse.ok) throw new Error('POST FormData failed');
                        
                    } catch (error) {
                        console.log('‚ùå POST s FormData selhal, zkou≈°√≠m GET...');
                        
                        // Pokus #2: GET s parametry (fallback)
                        const params = new URLSearchParams();
                        
                        // P≈ôid√°n√≠ akce
                        params.append('action', payload.action);
                        
                        // P≈ôid√°n√≠ v≈°ech dat z formul√°≈ôe
                        Object.keys(payload.data).forEach(key => {
                            const value = payload.data[key];
                            if (value !== null && value !== undefined && value !== '') {
                                params.append(key, value.toString());
                            }
                        });
                        
                        console.log('üîÑ Pokus #2: GET s parametry');
                        console.log('üìã URL parametry:', params.toString());
                        
                        const url = `https://script.google.com/macros/s/AKfycbyPrVbibH_2dCL-9MFRYkSURIV4_bQdruuX-BrGT00Z0kJTOP8cqs3kZ9SaOpXZ7qFA/exec?${params.toString()}`;
                        
                        finalResponse = await fetch(url, {
                            method: 'GET'
                        });
                        
                        if (!finalResponse.ok) {
                            const errorText = await finalResponse.text();
                            console.error('‚ùå V≈°echny pokusy selhaly. Posledn√≠ chyba:', errorText);
                            throw new Error(`HTTP error! status: ${finalResponse.status} - ${errorText}`);
                        }
                    }
                    
                    console.log('üì° Response status:', finalResponse.status);
                    console.log('üì° Response headers:', finalResponse.headers);
                    
                    // Pokus o parsov√°n√≠ JSON odpovƒõdi
                    let result;
                    const responseText = await finalResponse.text();
                    console.log('üìÑ Raw response:', responseText.substring(0, 200) + '...');
                    
                    try {
                        result = JSON.parse(responseText);
                        console.log('üìä Parsed JSON response:', result);
                    } catch (parseError) {
                        console.error('‚ùå JSON Parse Error:', parseError);
                        console.log('üìÑ Full response text:', responseText);
                        
                        // Pokud response obsahuje "success", pova≈æuj to za √∫spƒõch
                        if (responseText.includes('success') || responseText.includes('√∫spƒõ≈°nƒõ')) {
                            result = { success: true, message: 'Data byla √∫spƒõ≈°nƒõ ulo≈æena' };
                        } else {
                            throw new Error(`Neplatn√° JSON odpovƒõƒè: ${responseText.substring(0, 100)}`);
                        }
                    }
                    
                    if (result.success) {
                        // √öspƒõ≈°n√© ulo≈æen√≠ - zobrazit vesel√Ω smajl√≠k
                        showSuccessAnimation();
                        showMessage('üòä √öspƒõ≈°nƒõ odesl√°no do Google Sheets!', 'success');
                        
                        // P≈ôid√°n√≠ glow efektu k formul√°≈ôi
                        newBazarForm.classList.add('form-success-glow');
                        
                        // Reset formul√°≈ôe po 3 sekund√°ch
                        setTimeout(() => {
                            hideForm();
                            newBazarForm.classList.remove('form-success-glow');
                            // Obnoven√≠ dat v tabulce
                            if (window.bazarLoader && window.bazarLoader.loadBazarData) {
                                window.bazarLoader.loadBazarData();
                            }
                        }, 3000);
                        
                        console.log('‚úÖ Bazar z√°znam √∫spƒõ≈°nƒõ ulo≈æen do Google Sheets');
                        
                    } else {
                        throw new Error(result.error || 'Nezn√°m√° chyba ze serveru');
                    }
                    
                } catch (error) {
                    console.error('‚ùå Chyba p≈ôi odes√≠l√°n√≠ na Google Apps Script:', error);
                    
                    let errorMessage = 'üòû Nepoda≈ôilo se odeslat data';
                    let errorDetails = [];
                    
                    if (error.message.includes('Failed to fetch')) {
                        errorMessage = 'üåê Probl√©m s p≈ôipojen√≠m k internetu';
                        errorDetails = ['Zkontrolujte internetov√© p≈ôipojen√≠ a zkuste to znovu'];
                    } else if (error.message.includes('HTTP error')) {
                        errorMessage = '‚ö†Ô∏è Chyba serveru';
                        errorDetails = ['Server je moment√°lnƒõ nedostupn√Ω, zkuste to pozdƒõji'];
                    } else if (error.message.includes('Nezn√°m√° chyba')) {
                        errorMessage = 'üîß Probl√©m se zpracov√°n√≠m dat';
                        errorDetails = ['Zkontrolujte vyplnƒõn√° data a zkuste to znovu'];
                    } else {
                        errorDetails = [error.message];
                    }
                    
                    // Zobrazit smutn√Ω smajl√≠k a d≈Øvod chyby
                    showErrorAnimation(errorDetails);
                    showMessage(`${errorMessage}: ${errorDetails.join(', ')}`, 'error');
                    
                    // P≈ôid√°n√≠ shake efektu k formul√°≈ôi
                    newBazarForm.classList.add('form-error-shake');
                    setTimeout(() => {
                        newBazarForm.classList.remove('form-error-shake');
                    }, 3000);
                    
                } finally {
                    // Obnovit tlaƒç√≠tko
                    submitButton.disabled = false;
                    submitButton.innerHTML = originalButtonText;
                }
            }
            
            // Inicializace kalend√°≈ôov√Ωch input≈Ø s lep≈°√≠m timingem
            setTimeout(() => {
                console.log('üîÑ Spou≈°t√≠m inicializaci kalend√°≈ôov√Ωch rolov√°tka...');
                initializeDateInputs();
                
                // P≈ôidej event listenery pro toggle tlaƒç√≠tka
                setupToggleButtons();
            }, 500);
        }
        
        // Funkce pro vyplnƒõn√≠ testovac√≠ch dat
        function fillTestData() {
            console.log('üß™ Vypl≈àuji testovac√≠ data...');
            
            // Z√°kladn√≠ informace
            document.getElementById('vykupka').value = 'TEST001';
            document.getElementById('typTelefonu').value = 'iPhone 13 Pro';
            document.getElementById('imei').value = '123456789012345';
            document.getElementById('jakSeONasDozvedelKlient').value = 'internet';
            document.getElementById('cena').value = '15000';
            document.getElementById('nabijjecka').value = 'ano';
            document.getElementById('krabicka').value = 'ano';
            document.getElementById('zarucniList').value = 'ano';
            document.getElementById('zarukaDo').value = '15.12.2025';
            document.getElementById('pouziteDily').value = '0';
            document.getElementById('vykoupil').value = 'Nov√°k';
            
            // Informace o klientovi
            document.getElementById('jmenoKlienta').value = 'Jan';
            document.getElementById('prijmeniKlienta').value = 'Testovac√≠';
            document.getElementById('adresaKlienta').value = 'Testovac√≠ 123, Praha 1';
            document.getElementById('rodneCislo').value = '900101/1234';
            document.getElementById('rodinnyStav').value = 'svobodn√Ω/√°';
            document.getElementById('mistoVydaniDokladu').value = 'Praha';
            document.getElementById('datumVydaniDokladu').value = '01.01.2020';
            document.getElementById('platnostDo').value = '01.01.2030';
            document.getElementById('datumNarozeni').value = '01.01.1990';
            document.getElementById('pohlavi').value = 'mu≈æ';
            document.getElementById('cisloOP').value = '123456789';
            document.getElementById('mistoNarozeni').value = 'Praha';
            document.getElementById('telefonniCislo').value = '+420 123 456 789';
            document.getElementById('poznamky').value = 'Testovac√≠ z√°znam pro kontrolu funkƒçnosti formul√°≈ôe.';
            
            console.log('‚úÖ Testovac√≠ data vyplnƒõna');
        }
        
        // Inicializace date input≈Ø s rolov√°tky
        function initializeDateInputs() {
            console.log('üóìÔ∏è Inicializuji date picker rolov√°tka...');
            const currentYear = new Date().getFullYear();
            
            // Naj√≠t v≈°echny year selecty
            const yearSelects = document.querySelectorAll('.year-select');
            console.log(`Nalezeno ${yearSelects.length} year select≈Ø`);
            
            // Inicializace v≈°ech year select≈Ø
            yearSelects.forEach((select, index) => {
                // Vyƒçistit existuj√≠c√≠ options (kromƒõ prvn√≠ pr√°zdn√©)
                while (select.children.length > 1) {
                    select.removeChild(select.lastChild);
                }
                
                // P≈ôid√°n√≠ rok≈Ø od souƒçasn√©ho roku do budoucna (10 let)
                for (let year = currentYear; year <= currentYear + 10; year++) {
                    const option = document.createElement('option');
                    option.value = year.toString();
                    option.textContent = year;
                    select.appendChild(option);
                }
                // Pak roky do minulosti
                for (let year = currentYear - 1; year >= 1920; year--) {
                    const option = document.createElement('option');
                    option.value = year.toString();
                    option.textContent = year;
                    select.appendChild(option);
                }
                
                console.log(`Year select ${index + 1} inicializov√°n s ${select.children.length - 1} roky`);
            });
            
            // Naj√≠t v≈°echny day selecty
            const daySelects = document.querySelectorAll('.day-select');
            console.log(`Nalezeno ${daySelects.length} day select≈Ø`);
            
            // Inicializace dn≈Ø (1-31)
            daySelects.forEach((select, index) => {
                // Vyƒçistit existuj√≠c√≠ options (kromƒõ prvn√≠ pr√°zdn√©)
                while (select.children.length > 1) {
                    select.removeChild(select.lastChild);
                }
                
                for (let day = 1; day <= 31; day++) {
                    const option = document.createElement('option');
                    option.value = day.toString().padStart(2, '0');
                    option.textContent = day;
                    select.appendChild(option);
                }
                
                console.log(`Day select ${index + 1} inicializov√°n s ${select.children.length - 1} dny`);
            });
            
            // Event listenery pro synchronizaci select≈Ø s text inputy
            const allDateSelects = document.querySelectorAll('.date-select');
            console.log(`Nalezeno ${allDateSelects.length} date select≈Ø celkem`);
            
            allDateSelects.forEach((select, index) => {
                select.addEventListener('change', function() {
                    console.log(`Date select ${index + 1} zmƒõnƒõn:`, this.dataset.field, '=', this.value);
                    updateDateInputFromSelects(this.dataset.field);
                });
            });
            
            console.log('‚úÖ Date picker rolov√°tka inicializov√°na');
        }
        
        // Nastaven√≠ toggle tlaƒç√≠tek pro kalend√°≈ôe
        function setupToggleButtons() {
            console.log('üîò Nastavuji toggle tlaƒç√≠tka...');
            
            const toggleButtons = document.querySelectorAll('.date-toggle-btn');
            console.log(`Nalezeno ${toggleButtons.length} toggle tlaƒç√≠tek`);
            
            toggleButtons.forEach((button, index) => {
                // Odebrat star√© event listenery
                const newButton = button.cloneNode(true);
                button.parentNode.replaceChild(newButton, button);
                
                // Naj√≠t fieldName z onclick atributu
                const onclickAttr = newButton.getAttribute('onclick');
                const fieldNameMatch = onclickAttr ? onclickAttr.match(/toggleDateInput\('([^']+)'\)/) : null;
                
                if (fieldNameMatch) {
                    const fieldName = fieldNameMatch[1];
                    console.log(`Toggle tlaƒç√≠tko ${index + 1} pro field: ${fieldName}`);
                    
                    newButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log(`üîò Kliknuto na toggle pro: ${fieldName}`);
                        toggleDateInput(fieldName);
                    });
                } else {
                    console.log(`‚ùå Nepoda≈ôilo se naj√≠t fieldName pro toggle ${index + 1}`);
                }
            });
            
            console.log('‚úÖ Toggle tlaƒç√≠tka nastavena');
        }
        
        // P≈ôep√≠n√°n√≠ mezi text inputem a rolov√°tky
        function toggleDateInput(fieldName) {
            const textInput = document.getElementById(fieldName);
            const selectsContainer = document.getElementById(fieldName + '_selects');
            const toggleBtn = textInput.parentNode.querySelector('.date-toggle-btn');
            const container = textInput.closest('.date-input-container');
            
            if (selectsContainer.style.display === 'none' || selectsContainer.style.display === '') {
                // Zobrazit rolov√°tka s animac√≠
                selectsContainer.style.display = 'grid';
                selectsContainer.classList.add('show');
                toggleBtn.innerHTML = 'üìù'; // Zmƒõnit ikonu na tu≈æku
                toggleBtn.title = 'P≈ôepnout na textov√© pole';
                
                // Oznaƒçit kontejner jako pou≈æ√≠vaj√≠c√≠ rolov√°tka
                container.classList.add('using-selects');
                
                // Synchronizovat hodnoty pokud je nƒõco zad√°no
                if (textInput.value) {
                    populateSelectsFromInput(fieldName, textInput.value);
                }
                
                // Disable text input p≈ôi pou≈æ√≠v√°n√≠ rolov√°tka
                textInput.readOnly = true;
                
                console.log('üìÖ Aktivov√°na rolov√°tka pro:', fieldName);
            } else {
                // Skr√Ωt rolov√°tka
                selectsContainer.style.display = 'none';
                selectsContainer.classList.remove('show');
                toggleBtn.innerHTML = 'üìÖ'; // Zmƒõnit ikonu zpƒõt na kalend√°≈ô
                toggleBtn.title = 'P≈ôepnout na rolov√°tka';
                
                // Odebrat oznaƒçen√≠ kontejneru
                container.classList.remove('using-selects');
                
                // Enable text input
                textInput.readOnly = false;
                
                console.log('üìù Aktivov√°no textov√© pole pro:', fieldName);
            }
        }
        
        // Naplnƒõn√≠ select≈Ø z text inputu
        function populateSelectsFromInput(fieldName, dateValue) {
            const parts = dateValue.split('.');
            if (parts.length === 3) {
                const daySelect = document.querySelector(`[data-field="${fieldName}"].day-select`);
                const monthSelect = document.querySelector(`[data-field="${fieldName}"].month-select`);
                const yearSelect = document.querySelector(`[data-field="${fieldName}"].year-select`);
                
                console.log(`üîÑ Synchronizuji selecty pro ${fieldName}:`, parts);
                
                if (daySelect && parts[0]) {
                    daySelect.value = parts[0].padStart(2, '0');
                    console.log(`Day nastaven na: ${daySelect.value}`);
                }
                if (monthSelect && parts[1]) {
                    monthSelect.value = parts[1].padStart(2, '0');
                    console.log(`Month nastaven na: ${monthSelect.value}`);
                }
                if (yearSelect && parts[2]) {
                    yearSelect.value = parts[2];
                    console.log(`Year nastaven na: ${yearSelect.value}`);
                }
            }
        }
        
        // Aktualizace text inputu z select≈Ø
        function updateDateInputFromSelects(fieldName) {
            const daySelect = document.querySelector(`[data-field="${fieldName}"].day-select`);
            const monthSelect = document.querySelector(`[data-field="${fieldName}"].month-select`);
            const yearSelect = document.querySelector(`[data-field="${fieldName}"].year-select`);
            const textInput = document.getElementById(fieldName);
            
            console.log(`üîÑ Aktualizuji text input pro ${fieldName}`);
            console.log(`Day: ${daySelect?.value}, Month: ${monthSelect?.value}, Year: ${yearSelect?.value}`);
            
            if (daySelect && monthSelect && yearSelect && 
                daySelect.value && monthSelect.value && yearSelect.value) {
                
                const day = daySelect.value.padStart(2, '0');
                const month = monthSelect.value.padStart(2, '0');
                const year = yearSelect.value;
                
                const dateString = `${day}.${month}.${year}`;
                textInput.value = dateString;
                console.log(`üìÖ Datum aktualizov√°no na: ${dateString}`);
                validateDateInput(textInput);
            } else if (textInput && (!daySelect.value || !monthSelect.value || !yearSelect.value)) {
                // Pokud nen√≠ v≈°echno vyplnƒõno, vyma≈æ text input
                textInput.value = '';
                console.log(`üìÖ Text input vymaz√°n pro ${fieldName}`);
            }
        }
        
        // Validace date inputu
        function validateDateInput(input) {
            const pattern = /^([0-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.([0-9]{4})$/;
            
            if (input.value && !pattern.test(input.value)) {
                input.style.borderColor = '#ef4444';
                input.style.boxShadow = '0 0 0 3px rgba(239, 68, 68, 0.1)';
            } else {
                input.style.borderColor = '';
                input.style.boxShadow = '';
            }
        }
        
        // Form√°tov√°n√≠ date inputu
        function formatDateInput(input) {
            let value = input.value.replace(/[^\d]/g, '');
            
            // Omezit na maximum 8 ƒç√≠slic
            if (value.length > 8) {
                value = value.substring(0, 8);
            }
            
            // Form√°tov√°n√≠ DD.MM.YYYY
            if (value.length >= 2) {
                value = value.substring(0, 2) + '.' + value.substring(2);
            }
            if (value.length >= 5) {
                value = value.substring(0, 5) + '.' + value.substring(5, 9);
            }
            
            input.value = value;
            
            // Validace pouze pokud je kompletn√≠ datum
            if (value.length === 10) {
                validateDateInput(input);
            }
        }
        
        // Validace cel√©ho formul√°≈ôe
        function validateForm() {
            const errors = [];
            
            // Povinn√° pole
            const requiredFields = [
                { id: 'vykupka', name: 'ƒå√≠slo v√Ωkupky' },
                { id: 'typTelefonu', name: 'Typ telefonu' },
                { id: 'imei', name: 'IMEI' },
                { id: 'cena', name: 'Cena' },
                { id: 'vykoupil', name: 'Kdo vykoupil' },
                { id: 'jmenoKlienta', name: 'Jm√©no klienta' },
                { id: 'prijmeniKlienta', name: 'P≈ô√≠jmen√≠ klienta' },
                { id: 'adresaKlienta', name: 'Adresa klienta' },
                { id: 'rodneCislo', name: 'Rodn√© ƒç√≠slo' },
                { id: 'mistoVydaniDokladu', name: 'M√≠sto vyd√°n√≠ dokladu' },
                { id: 'datumVydaniDokladu', name: 'Datum vyd√°n√≠ dokladu' },
                { id: 'platnostDo', name: 'Platnost do' },
                { id: 'datumNarozeni', name: 'Datum narozen√≠' },
                { id: 'pohlavi', name: 'Pohlav√≠' },
                { id: 'cisloOP', name: 'ƒå√≠slo OP' },
                { id: 'mistoNarozeni', name: 'M√≠sto narozen√≠' }
            ];
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    errors.push(`${field.name} je povinn√© pole`);
                    element.style.borderColor = '#ef4444';
                    element.style.boxShadow = '0 0 0 3px rgba(239, 68, 68, 0.1)';
                } else {
                    element.style.borderColor = '';
                    element.style.boxShadow = '';
                }
            });
            
            // Validace IMEI (pouze ƒç√≠slice, libovoln√Ω poƒçet)
            const imei = document.getElementById('imei').value.trim();
            if (imei && !/^\d+$/.test(imei)) {
                errors.push('IMEI m≈Ø≈æe obsahovat pouze ƒç√≠slice');
            }
            
            // Validace ceny (mus√≠ b√Ωt ƒç√≠slo vƒõt≈°√≠ ne≈æ 0)
            const cena = document.getElementById('cena').value.trim();
            if (cena && (isNaN(cena) || parseInt(cena) <= 0)) {
                errors.push('Cena mus√≠ b√Ωt kladn√© ƒç√≠slo');
            }
            
            // Validace rodn√©ho ƒç√≠sla (z√°kladn√≠ kontrola - pouze ƒç√≠slice a p≈ô√≠padn√© lom√≠tko)
            const rodneCislo = document.getElementById('rodneCislo').value.trim();
            if (rodneCislo && !/^[\d\/]+$/.test(rodneCislo)) {
                errors.push('Rodn√© ƒç√≠slo m≈Ø≈æe obsahovat pouze ƒç√≠slice a lom√≠tko');
            }
            
            // Validace telefonn√≠ho ƒç√≠sla (pokud je vyplnƒõno)
            const telefon = document.getElementById('telefonniCislo').value.trim();
            if (telefon && !/^(\+420)?\s?\d{3}\s?\d{3}\s?\d{3}$/.test(telefon)) {
                errors.push('Telefonn√≠ ƒç√≠slo mus√≠ b√Ωt ve spr√°vn√©m form√°tu');
            }
            
            return {
                isValid: errors.length === 0,
                errors: errors
            };
        }
        
        // Animace pro √∫spƒõch
        function showSuccessAnimation() {
            // Vytvo≈ôen√≠ konfet
            createConfetti();
            
            // P≈ôid√°n√≠ emoji a textu
            const successEmoji = document.createElement('div');
            successEmoji.className = 'success-emoji';
            successEmoji.innerHTML = 'üòä';
            successEmoji.style.top = '25%';
            successEmoji.style.left = '50%';
            successEmoji.style.transform = 'translateX(-50%)';
            successEmoji.style.fontSize = '5rem';
            successEmoji.style.textAlign = 'center';
            document.body.appendChild(successEmoji);
            
            const celebrationText = document.createElement('div');
            celebrationText.className = 'celebration-text';
            celebrationText.innerHTML = 'üéâ √öspƒõ≈°nƒõ odesl√°no! üéâ';
            celebrationText.style.top = '40%';
            document.body.appendChild(celebrationText);
            
            // P≈ôid√°n√≠ sparkle efekt≈Ø
            createSparkles();
            
            // Odstranƒõn√≠ po 4 sekund√°ch
            setTimeout(() => {
                if (successEmoji.parentNode) successEmoji.remove();
                if (celebrationText.parentNode) celebrationText.remove();
            }, 4000);
        }
        
        // Animace pro chybu
        function showErrorAnimation(errors) {
            const errorEmoji = document.createElement('div');
            errorEmoji.className = 'error-emoji';
            errorEmoji.innerHTML = 'üòû';
            errorEmoji.style.top = '25%';
            errorEmoji.style.left = '50%';
            errorEmoji.style.transform = 'translateX(-50%)';
            errorEmoji.style.fontSize = '5rem';
            errorEmoji.style.textAlign = 'center';
            document.body.appendChild(errorEmoji);
            
            const errorText = document.createElement('div');
            errorText.className = 'error-text';
            errorText.innerHTML = 'üòû Nƒõco se nepovedlo';
            errorText.style.top = '40%';
            document.body.appendChild(errorText);
            
            // P≈ôid√°n√≠ seznamu chyb pokud existuj√≠
            if (errors && errors.length > 0) {
                const errorDetails = document.createElement('div');
                errorDetails.style.position = 'fixed';
                errorDetails.style.top = '50%';
                errorDetails.style.left = '50%';
                errorDetails.style.transform = 'translateX(-50%)';
                errorDetails.style.fontSize = '1rem';
                errorDetails.style.color = '#dc2626';
                errorDetails.style.zIndex = '10000';
                errorDetails.style.textAlign = 'center';
                errorDetails.style.maxWidth = '80vw';
                errorDetails.style.padding = '10px';
                errorDetails.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
                errorDetails.style.borderRadius = '8px';
                errorDetails.innerHTML = errors.slice(0, 3).join('<br>'); // Max 3 chyby
                document.body.appendChild(errorDetails);
                
                setTimeout(() => {
                    if (errorDetails.parentNode) errorDetails.remove();
                }, 5000);
            }
            
            // Odstranƒõn√≠ po 5 sekund√°ch
            setTimeout(() => {
                if (errorEmoji.parentNode) errorEmoji.remove();
                if (errorText.parentNode) errorText.remove();
            }, 5000);
        }
        
        // Vytvo≈ôen√≠ konfet
        function createConfetti() {
            const animationOverlay = document.createElement('div');
            animationOverlay.className = 'animation-overlay';
            document.body.appendChild(animationOverlay);
            
            // Vytvo≈ôen√≠ 50 konfet
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                animationOverlay.appendChild(confetti);
            }
            
            // Odstranƒõn√≠ overlay po 5 sekund√°ch
            setTimeout(() => {
                animationOverlay.remove();
            }, 5000);
        }
        
        // Vytvo≈ôen√≠ sparkle efekt≈Ø
        function createSparkles() {
            const sparkleContainer = document.createElement('div');
            sparkleContainer.style.position = 'fixed';
            sparkleContainer.style.top = '0';
            sparkleContainer.style.left = '0';
            sparkleContainer.style.width = '100vw';
            sparkleContainer.style.height = '100vh';
            sparkleContainer.style.pointerEvents = 'none';
            sparkleContainer.style.zIndex = '9998';
            document.body.appendChild(sparkleContainer);
            
            // Vytvo≈ôen√≠ 20 sparkles
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.innerHTML = '‚ú®';
                sparkle.style.left = Math.random() * 100 + 'vw';
                sparkle.style.top = Math.random() * 100 + 'vh';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                sparkleContainer.appendChild(sparkle);
            }
            
            // Odstranƒõn√≠ po 3 sekund√°ch
            setTimeout(() => {
                sparkleContainer.remove();
            }, 3000);
        }
        
        // Funkce pro skryt√≠ obsahu podle role u≈æivatele
        function setupRoleBasedAccess() {
            const userRole = localStorage.getItem('role');
            console.log('Kontrola role pro bazar:', userRole);
            
            if (userRole === 'Prodejce') {
                console.log('U≈æivatel je Prodejce - skr√Ωv√°m statistiky a zobrazuji pouze formul√°≈ô');
                
                // Skryt√≠ v≈°ech sekc√≠ kromƒõ formul√°≈ôe
                const sectionsToHide = [
                    'hero', // hero sekce s nadpisem
                    'dataCont', // kontejner s daty
                    'retro' // retro tabulka
                ];
                
                sectionsToHide.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.style.display = 'none';
                    }
                });
                
                // Skryt√≠ v≈°ech div element≈Ø s tabulkami a statistikami
                document.querySelectorAll('.data-container:not(#newBazarForm)').forEach(container => {
                    container.style.display = 'none';
                });
                
                // Zmƒõna nadpisu str√°nky
                document.title = 'P≈ôidat v√Ωkup - Mobil Maj√°k';
                
                // √öprava hero sekce jen pro formul√°≈ô
                const heroSection = document.querySelector('.hero');
                if (heroSection) {
                    heroSection.innerHTML = `
                        <div class="container">
                            <h1>P≈ôidat nov√Ω v√Ωkup</h1>
                            <p>Formul√°≈ô pro registraci v√Ωkupu mobiln√≠ho telefonu</p>
                        </div>
                    `;
                    heroSection.style.display = 'block';
                }
                
                                 // Automatick√© otev≈ôen√≠ formul√°≈ôe pro prodejce
                 setTimeout(() => {
                     const newBazarBtn = document.getElementById('newBazarBtn');
                     const newBazarForm = document.getElementById('newBazarForm');
                     
                     if (newBazarBtn && newBazarForm) {
                         newBazarForm.style.display = 'block';
                         newBazarBtn.style.display = 'none';
                         console.log('Formul√°≈ô automaticky otev≈ôen pro prodejce');
                         
                         // Scroll k formul√°≈ôi
                         newBazarForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
                     }
                 }, 100);
                 
                 // √öprava close buttonu pro prodejce - p≈ôesmƒõrov√°n√≠ na prodejny
                 setTimeout(() => {
                     const closeBtn = document.getElementById('closeFormBtn');
                     if (closeBtn) {
                         closeBtn.addEventListener('click', function() {
                             window.location.href = 'prodejny.html';
                         });
                     }
                 }, 200);
            } else {
                console.log('U≈æivatel je Administr√°tor - zobrazuji pln√Ω obsah');
            }
        }
        
        // Vol√°n√≠ p≈ôi naƒçten√≠ str√°nky
        document.addEventListener('DOMContentLoaded', function() {
            setupRoleBasedAccess();
        });
    </script>
</body>
</html> 